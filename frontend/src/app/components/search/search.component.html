<div class="container">
    <form [formGroup]="searchForm" (ngSubmit)="onSubmit()">
        <div class="jumbotron" style="padding:20px 40px 20px 50px">
            <h2>Data Browser
                <small>
                    <span class="badge badge-pill badge-secondary">hg19</span>
                </small>
            </h2>

            <div class="row">
                <div class="col-md-9 form-group">
                    <div class="input-group">
                        <input [attr.disabled]="loading ? true : null" id="query" formControlName="query"
                            class="form-control" type="text" placeholder="Search by variant, gene or region">
                        <div class="input-group-append">
                            <button [disabled]="loading" class="btn btn-primary" type="submit">
                                <span *ngIf="loading" class="spinner-border spinner-border-sm mr-1"></span>
                                <i *ngIf="!loading" class="fas fa-search"></i>
                            </button>
                        </div>
                    </div>

                    <p class="text-muted" style="margin-left: 5px">
                        Examples -
                        Variant: <a href="/variant/21-33040861-G-C}">21-33040861-G-C</a>,
                        Gene: <a href="/gene/TBK1}">TBK1</a>,
                        Region: <a href="/region/2:166892071-166893071}">2:166892071-166893071</a>
                    </p>
                </div>

                <div class="col-md-3 form-group text-center">
                    <div class="bg-light">
                        <h2>{{ sampleCount | number }}</h2>
                        <p><i class="fas fa-dna"></i> NGS Samples</p>
                    </div>
                </div>
            </div>

            <div class="form-row align-items-center">
                <div class="col-md-auto form-group" data-toggle="tooltip" title="Search variants by selected phenotype">
                    <label>Phenotype:</label>
                    <select [attr.disabled]="loading ? true : null" formControlName="phenotype" class="form-control">
                        <option *ngFor="let phenotype of PHENOTYPE_LIST" [value]="phenotype">{{phenotype}}</option>
                    </select>
                </div>

                <div class="col-md-auto form-group" data-toggle="tooltip"
                    title="Search variants when its AF <= cutoff or AF >= (1 - cutoff)">
                    <label>MAF:</label>
                    <select [attr.disabled]="loading ? true : null" formControlName="maf" class="form-control">
                        <option *ngFor="let maf of MAF_LIST" [value]="maf">{{maf}}</option>
                    </select>
                </div>

                <div class="col-md-auto form-group">
                    <div class="custom-control custom-switch" data-toggle="tooltip" title="DP_bin >= 10; GQ >= 20; SNV-SOR <= 3; INDEL-SOR <= 10; 
                             SNV-FS <= 60; INDEL-FS <= 200; MQ >= 40; QD >= 5; Qual >= 50; RPRS >= -3; 
                             MQRS >= -10; FILTER = PASS or LIKELY or INTERMEDIATE">
                        <input [attr.disabled]="loading ? true : null" type="checkbox" class="custom-control-input"
                            formControlName="isHighQualityVariant">
                        <label class="custom-control-label">High Quality Variant</label>
                    </div>
                </div>

                <div class="col-md-auto form-group">
                    <div class="custom-control custom-switch" data-toggle="tooltip"
                        title="All External AF are 0, 1 or NA">
                        <input [attr.disabled]="loading ? true : null" type="checkbox" class="custom-control-input"
                            formControlName="isUltraRareVariant">
                        <label class="custom-control-label">Ultra Rare Variant</label>
                    </div>
                </div>

                <div class="col-md-auto form-group">
                    <div class="custom-control custom-switch" data-toggle="tooltip"
                        title="Available as control used samples in sequenceDB">
                        <input [attr.disabled]="loading ? true : null" type="checkbox" class="custom-control-input"
                            formControlName="isPublicAvailable">
                        <label class="custom-control-label">Public Available Sample</label>
                    </div>
                </div>
            </div>
        </div>
    </form>

    <div [hidden]="!variants">
        <div class="row">
            <div class="col">
                <h4><mark>Query: {{f.query.value}}</mark></h4>
            </div>

            <div class="col-md-auto">
                <a class="btn btn-outline-secondary btn-sm" href="https://decipher.sanger.ac.uk/gene/{{f.query.value}}"
                    target="_blank">DECIPHER</a>
            </div>
            <div class="col-md-auto">
                <a class="btn btn-outline-secondary btn-sm"
                    href="https://grch37.ensembl.org/Homo_sapiens/Gene/Summary?g={{f.query.value}}"
                    target="_blank">Ensembl</a>
            </div>
            <div class="col-md-auto">
                <a class="btn btn-outline-secondary btn-sm"
                    href="https://www.genecards.org/cgi-bin/carddisp.pl?gene={{f.query.value}}"
                    target="_blank">GeneCards</a>
            </div>
            <div class="col-md-auto">
                <a class="btn btn-outline-secondary btn-sm"
                    href="https://www.genenames.org/tools/search/#!/genes?query={{f.query.value}}"
                    target="_blank">HGNC</a>
            </div>
            <div class="col-md-auto">
                <a class="btn btn-outline-secondary btn-sm" href="http://igmdx.org/Search?query={{f.query.value}}"
                    target="_blank">IGMDx</a>
            </div>
            <div class="col-md-auto">
                <a class="btn btn-outline-secondary btn-sm" href="https://omim.org/search?search={{f.query.value}}"
                    target="_blank">OMIM</a>
            </div>
            <div class="col-md-auto">
                <a class="btn btn-outline-secondary btn-sm"
                    href="http://genic-intolerance.org/Search?query={{f.query.value}}" target="_blank">RVIS</a>
            </div>
        </div>

        <div class="card">
            <div class="card-body">
                <h4 class="card-title">Variant</h4>

                <div class='table-responsive'>
                    <table datatable [dtOptions]="dtOptions" [dtTrigger]="dtTrigger" class="table table-sm table-hover text-center">
                        <thead>
                            <tr>
                                <th class="align-middle" data-toggle="tooltip" title="chr-pos-ref-alt">Variant ID</th>
                                <th class="align-middle" data-toggle="tooltip"
                                    title="HGVS_p or HGVS_c for most damaging effect (Ensemble 87)">Consequence</th>
                                <th class="align-middle" data-toggle="tooltip"
                                    title="Consequence type of this variation for most damaging effect (Ensemble 87)">
                                    Effect
                                </th>
                                <th class="align-middle" data-toggle="tooltip"
                                    title="HGNC gene for most damaging effect (Ensemble 87)">Gene</th>
                                <th class="align-middle" data-toggle="tooltip" title="Allele Acount">AC</th>
                                <th class="align-middle" data-toggle="tooltip"
                                    title="Allele Number (total number of alleles)">AN</th>
                                <th class="align-middle" data-toggle="tooltip" title="Allele Frequency">AF</th>
                                <th class="align-middle" data-toggle="tooltip" title="Number of samples having data">NS
                                </th>
                                <th class="align-middle" data-toggle="tooltip" title="Number of homozygotes">NHOM</th>
                                <th class="align-middle" data-toggle="tooltip"
                                    title="Maximum External Allele Frequency">maxEAF</th>
                            </tr>
                        </thead>

                        <tbody>
                            <tr *ngFor="let variant of variants">
                                <td class="align-middle">
                                    <a href="/variant/{{variant.variantIdStr}}" target='_blank'>
                                        {{variant.variantIdStr}}
                                    </a>
                                </td>
                                <td class="align-middle">{{variant.consequence}}</td>
                                <td class="align-middle">{{variant.effect}}</td>
                                <td class="align-middle">{{variant.geneName}}</td>
                                <td class="align-middle">{{variant.ac}}</td>
                                <td class="align-middle">{{variant.an}}</td>
                                <td class="align-middle">{{variant.af}}</td>
                                <td class="align-middle">{{variant.ns}}</td>
                                <td class="align-middle">{{variant.nhom}}</td>
                                <td class="align-middle">{{variant.maxEAF}}</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</div>

<br/>
<br/>
<br/>